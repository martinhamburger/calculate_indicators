çœæµ1ï¼š
æ‰“å¼€mainæ–‡ä»¶å¤¹å¹¶åœ¨ç»ˆç«¯è¾“å…¥
```bash
python calculate.py -d ./å‡€å€¼åˆ—è¡¨
```
å³å¯è·å¾—ä¸€ä¸ª `output`.

çœæµ2ï¼š
æ‰“å¼€mainæ–‡ä»¶å¤¹å¹¶åœ¨ç»ˆç«¯è¾“å…¥
```bash
python buy_avg_return.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx
```
å³å¯è·å¾—ä¸€ä¸ªä¹°å…¥å¹³å‡ `_output`.

çœæµ3ï¼š
æ‰“å¼€mainæ–‡ä»¶å¤¹å¹¶åœ¨ç»ˆç«¯è¾“å…¥
```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule friday --format both -o ./my_output
```
åŒæ—¶ç”Ÿæˆ Excel å’Œ TXT æ–‡ä»¶ï¼Œä¿å­˜åˆ° `./my_output` ç›®å½•

æ›´è¿›ä¸€æ­¥çš„æ ¼å¼è¦æ±‚ï¼š
A1æ˜¯äº§å“åç§°ï¼ŒB1æ˜¯äº§å“ä»£ç ã€‚
A2-C2æ˜¯è¡¨å¤´ã€‚
A3å¼€å§‹æ˜¯æ•°æ®ã€‚
.xlsxæ”¾å…¥å‡€å€¼åˆ—è¡¨æ–‡ä»¶å¤¹å³å¯.



# äº§å“å‡€å€¼è®¡ç®—å™¨

äº§å“å‡€å€¼ä¸šç»©æŒ‡æ ‡è®¡ç®—å·¥å…·ï¼Œæ”¯æŒå•ä¸ªæ–‡ä»¶æˆ–æ‰¹é‡å¤„ç†ç›®å½•ä¸‹æ‰€æœ‰Excelæ–‡ä»¶ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- æ”¯æŒå€’åºæ•°æ®ï¼ˆæ—¥æœŸä»æ–°åˆ°æ—§æ’åˆ—ï¼‰
- è‡ªåŠ¨è®¡ç®—å¹´åŒ–æ”¶ç›Šç‡ã€æ³¢åŠ¨ç‡ã€å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤ç­‰æŒ‡æ ‡
- æ”¯æŒå¹´åº¦ã€æœˆåº¦å¤šç»´åº¦åˆ†æ
- è¾“å‡ºExcelæ–‡ä»¶è‡ªåŠ¨è®¾ç½®åˆ—å®½ï¼Œä¾¿äºæŸ¥çœ‹

## Excel æ ¼å¼è¦æ±‚

æ¯ä¸ªäº§å“çš„Excelæ–‡ä»¶éœ€æŒ‰ä»¥ä¸‹æ ¼å¼ç»„ç»‡ï¼š

|  | A | B | C |
|---|---|---|---|
| **1** | äº§å“åç§° | äº§å“ä»£ç  |  |
| **2** | æ—¥æœŸ | å•ä½å‡€å€¼ | ç´¯è®¡å‡€å€¼ |
| **3** | 20260116 | 2.9353 | 2.9353 |
| **4** | 20260112 | 2.8195 | 2.8195 |
| **5** | 20260109 | 2.8323 | 2.8323 |
| ... | ... | ... | ... |

**è¯´æ˜ï¼š**
- A1ï¼šäº§å“åç§°ï¼ˆå¦‚ "é”è¿›58æºä¹æ™Ÿå°Šäº«A"ï¼‰
- B1ï¼šäº§å“ä»£ç ï¼ˆå¦‚ "XA1796"ï¼‰
- A2-C2ï¼šåˆ—æ ‡é¢˜ï¼ˆæ—¥æœŸã€å•ä½å‡€å€¼ã€ç´¯è®¡å‡€å€¼ï¼‰
- A3èµ·ï¼šå‡€å€¼æ•°æ®ï¼ˆæ—¥æœŸæ ¼å¼ï¼šYYYYMMDDï¼‰
- æ•°æ®æŒ‰**æ—¥æœŸå€’åº**æ’åˆ—ï¼ˆæœ€æ–°æ—¥æœŸåœ¨å‰ï¼‰

**æ³¨æ„ï¼š** è®¡ç®—ä¸­ä»…ä½¿ç”¨"å•ä½å‡€å€¼"åˆ—ï¼Œ"ç´¯è®¡å‡€å€¼"åˆ—ä¸å‚ä¸è®¡ç®—ã€‚

## å®‰è£…ä¾èµ–

```bash
pip install pandas openpyxl
```

## å‘½ä»¤è¡Œä½¿ç”¨

### å¤„ç†å•ä¸ªæ–‡ä»¶

```bash
# åŸºæœ¬ç”¨æ³•
python calculate.py -f äº§å“å‡€å€¼.xlsx

# æŒ‡å®šè¾“å‡ºç›®å½•
python calculate.py -f äº§å“å‡€å€¼.xlsx -o ./results

# æŒ‡å®šæ— é£é™©åˆ©ç‡ï¼ˆé»˜è®¤2%ï¼‰
python calculate.py -f äº§å“å‡€å€¼.xlsx --risk-free 0.03
```

### æ‰¹é‡å¤„ç†ç›®å½•

```bash
# å¤„ç†ç›®å½•ä¸‹æ‰€æœ‰Excelæ–‡ä»¶
python calculate.py -d ./å‡€å€¼ç›®å½•

# å¤„ç†å¹¶ç”Ÿæˆæ±‡æ€»æ–‡ä»¶
python calculate.py -d ./å‡€å€¼ç›®å½• -s æ±‡æ€».xlsx

# æŒ‡å®šè¾“å‡ºç›®å½•å’Œæ±‡æ€»æ–‡ä»¶å
python calculate.py -d ./å‡€å€¼ç›®å½• -o ./results -s ä¸šç»©æ±‡æ€».xlsx
```

## å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `-f, --file` | å•ä¸ªExcelæ–‡ä»¶è·¯å¾„ | - |
| `-d, --dir` | åŒ…å«Excelæ–‡ä»¶çš„ç›®å½•è·¯å¾„ | - |
| `-o, --output` | è¾“å‡ºç›®å½• | `./output` |
| `-s, --summary` | æ±‡æ€»æ–‡ä»¶åï¼ˆå¤šæ–‡ä»¶æ—¶ç”Ÿæˆï¼‰ | `ä¸šç»©æ±‡æ€».xlsx` |
| `--risk-free` | æ— é£é™©åˆ©ç‡ | `0.02` (2%) |

## è¾“å‡ºè¯´æ˜

### å•ä¸ªäº§å“è¾“å‡º

æ¯ä¸ªäº§å“ç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„Excelæ–‡ä»¶ï¼ˆ`_ç»“æœ.xlsx`ï¼‰ï¼ŒåŒ…å«ä»¥ä¸‹sheetï¼š

1. **ä¸šç»©æŒ‡æ ‡è®¡ç®—** - äº§å“åç§°ã€ä»£ç ã€æœ€æ–°å‡€å€¼æ—¥æœŸã€æœ€æ–°å‡€å€¼ã€æˆç«‹ä»¥æ¥æ”¶ç›Šç‡ã€å¹´åŒ–æ”¶ç›Šç‡ã€å¹´åŒ–æ³¢åŠ¨ç‡ã€å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤åŠæ—¥æœŸã€è¿‘ä¸€å¹´æœ€å¤§å›æ’¤åŠæ—¥æœŸ
2. **å¹´åº¦æ”¶ç›Šç‡** - å„å¹´åº¦æ”¶ç›Šç‡æ˜ç»†
3. **å‘¨é¢‘è®¡ç®—å†å²æœ€å¤§å›æ’¤** - åŸºäºå‘¨é¢‘æ•°æ®çš„å¹´åº¦æœ€å¤§å›æ’¤
4. **æœˆé¢‘è®¡ç®—å†å²æœ€å¤§å›æ’¤** - åŸºäºæœˆé¢‘æ•°æ®çš„å¹´åº¦æœ€å¤§å›æ’¤
5. **æˆç«‹ä»¥æ¥æœˆåº¦æ”¶ç›Š** - æœˆåº¦æ”¶ç›ŠçŸ©é˜µåŠå…¨å¹´æ”¶ç›Š

**è¾“å‡ºç‰¹ç‚¹ï¼š**
- å„sheetè‡ªåŠ¨è®¾ç½®åˆ—å®½ï¼Œä¾¿äºæŸ¥çœ‹å®Œæ•´æ•°æ®
- æ•°å€¼å‹æ•°æ®è‡ªåŠ¨ä¿ç•™4ä½å°æ•°
- æ—¥æœŸæ ¼å¼ä¿æŒåŸæ ·æ˜¾ç¤º

### æ±‡æ€»æ–‡ä»¶è¾“å‡º

å¤„ç†å¤šä¸ªäº§å“æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆæ±‡æ€»æ–‡ä»¶ `ä¸šç»©æ±‡æ€».xlsx`ï¼ŒåŒ…å«æ‰€æœ‰äº§å“çš„æ ¸å¿ƒä¸šç»©æŒ‡æ ‡ï¼ŒæŒ‰æˆç«‹ä»¥æ¥æ”¶ç›Šç‡é™åºæ’åˆ—ã€‚

## Python API ä½¿ç”¨

```python
from utils import ProductNetValueCalculator

# åˆ›å»ºè®¡ç®—å™¨
calculator = ProductNetValueCalculator(
    file_path="äº§å“å‡€å€¼.xlsx",
    risk_free_rate=0.02  # å¯é€‰ï¼Œé»˜è®¤2%
)

# æ‰§è¡Œæ‰€æœ‰è®¡ç®—
calculator.run_all_calculations()

# æ‰“å°æ‘˜è¦
calculator.print_summary()

# ä¿å­˜è¯¦ç»†ç»“æœ
calculator.save_to_excel("äº§å“å‡€å€¼_ç»“æœ.xlsx")

# è·å–å„ç»´åº¦æ•°æ®
annual_returns = calculator.get_annual_returns()
monthly_matrix = calculator.get_monthly_return_matrix()
metrics_df = calculator.build_metrics_df()
```

## è®¡ç®—æŒ‡æ ‡è¯´æ˜

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| æˆç«‹ä»¥æ¥æ”¶ç›Šç‡ | æœ€æ–°å‡€å€¼ / é¦–æ—¥å‡€å€¼ - 1 |
| å¹´åŒ–æ”¶ç›Šç‡ | (1 + æˆç«‹ä»¥æ¥æ”¶ç›Šç‡)^(52/å‘¨æ•°) - 1 |
| å¹´åŒ–æ³¢åŠ¨ç‡ | å‘¨æ”¶ç›Šç‡æ ‡å‡†å·® Ã— âˆš52 |
| å¤æ™®æ¯”ç‡ | (å¹´åŒ–æ”¶ç›Šç‡ - æ— é£é™©åˆ©ç‡) / å¹´åŒ–æ³¢åŠ¨ç‡ |
| æœ€å¤§å›æ’¤ | å†å²æœ€é«˜å‡€å€¼åˆ°æœ€ä½å‡€å€¼çš„æœ€å¤§è·Œå¹… |
| è¿‘ä¸€å¹´æœ€å¤§å›æ’¤ | è¿‘ä¸€å¹´æœŸé—´çš„æœ€å¤§å›æ’¤ |

## æ•°æ®è¦æ±‚

- æ¯ä¸ªExcelæ–‡ä»¶è‡³å°‘éœ€è¦ **2æ¡** å‡€å€¼æ•°æ®æ‰èƒ½è¿›è¡Œè®¡ç®—
- æ—¥æœŸæ ¼å¼æ”¯æŒ `YYYYMMDD`ï¼ˆå¦‚ 20260116ï¼‰
- æ•°æ®æŒ‰æ—¥æœŸ**å€’åº**æ’åˆ—ï¼ˆæœ€æ–°æ—¥æœŸåœ¨å‰ï¼Œæœ€æ—©æ—¥æœŸåœ¨åï¼‰
- æ”¯æŒ `.xlsx`ã€`.xls`ã€`.xlsm` æ ¼å¼

---

# ä¹°å…¥å¹³å‡æ”¶ç›Šè®¡ç®—å™¨

è®¡ç®—æ¯æœˆæŒ‡å®šå¼€æ”¾æ—¥ï¼ˆé»˜è®¤20æ—¥ï¼‰ä»¥æ¥çš„æ”¶ç›Šï¼Œæ”¯æŒå‘½ä»¤è¡Œå’ŒPython APIä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- æ¯æœˆ20æ—¥ä½œä¸ºå¼€æ”¾æ—¥ï¼ˆå¦‚æ— 20æ—¥åˆ™è·³è¿‡ï¼‰
- è®¡ç®—æ¯ä¸ªå¼€æ”¾æ—¥ä¹°å…¥æŒæœ‰è‡³ä»Šçš„æ”¶ç›Šç‡
- æŒ‰å¹´ä»½åˆ†ç»„è¾“å‡ºä¸ºæ ¼å¼åŒ–çš„txtæ–‡ä»¶
- æ”¯æŒè‡ªå®šä¹‰å¼€æ”¾æ—¥æ—¥æœŸ

## å‘½ä»¤è¡Œä½¿ç”¨

```bash
# åŸºæœ¬ç”¨æ³•
python buy_avg_return.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx

# æŒ‡å®šè¾“å‡ºç›®å½•
python buy_avg_return.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx -o ./ä¹°å…¥å¹³å‡_output
```

## è¾“å‡ºç¤ºä¾‹

ç”Ÿæˆçš„txtæ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼š

```
â­ï¸2025å¹´
ğŸ”º1æœˆä¹°å…¥å¹³å‡æ”¶ç›Š37.39%
ğŸ”º2æœˆä¹°å…¥å¹³å‡æ”¶ç›Š24.64%
ğŸ”º3æœˆä¹°å…¥å¹³å‡æ”¶ç›Š21.37%
ğŸ”º5æœˆä¹°å…¥å¹³å‡æ”¶ç›Š31.35%
ğŸ”º6æœˆä¹°å…¥å¹³å‡æ”¶ç›Š35.38%
ğŸ”º8æœˆä¹°å…¥å¹³å‡æ”¶ç›Š15.84%
ğŸ”º10æœˆä¹°å…¥å¹³å‡æ”¶ç›Š9.91%
ğŸ”º11æœˆä¹°å…¥å¹³å‡æ”¶ç›Š11.76%

â­ï¸2024å¹´
ğŸ”º2æœˆä¹°å…¥å¹³å‡æ”¶ç›Š66.30%
ğŸ”º3æœˆä¹°å…¥å¹³å‡æ”¶ç›Š52.27%
...
```

## Python API ä½¿ç”¨

```python
from utils import BuyAvgReturnCalculator

# åˆ›å»ºè®¡ç®—å™¨
calculator = BuyAvgReturnCalculator("æ—¥åº¦å‡€å€¼.xlsx")

# æ‰§è¡Œæ‰€æœ‰è®¡ç®—
calculator.run_all()

# è·å–äº§å“ä¿¡æ¯
info = calculator.get_product_info()
print(f"äº§å“åç§°: {info['name']}")
print(f"æ•°æ®æ—¥æœŸèŒƒå›´: {info['date_range']}")
print(f"å¼€æ”¾æ—¥æ•°é‡: {info['open_day_count']}")

# è·å–ç»“æœï¼ˆå­—å…¸æ ¼å¼ï¼‰
results = calculator.results
# results æ ¼å¼: {å¹´ä»½: {æœˆä»½: æ”¶ç›Šç‡}}

# ç”Ÿæˆæ ¼å¼åŒ–æ–‡æœ¬
text = calculator.generate_output_text()

# ä¿å­˜åˆ°txtæ–‡ä»¶
calculator.save_to_txt("output.txt")
```

## BuyAvgReturnCalculator ç±»æ–¹æ³•

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| `__init__(file_path)` | åˆå§‹åŒ–ï¼ŒæŒ‡å®šExcelæ–‡ä»¶è·¯å¾„ |
| `get_open_day_data(day=20)` | è·å–æŒ‡å®šæ—¥æœŸçš„å¼€æ”¾æ—¥æ•°æ® |
| `calculate_returns_since_open_day()` | è®¡ç®—æ¯ä¸ªå¼€æ”¾æ—¥ä»¥æ¥çš„æ”¶ç›Šç‡ |
| `generate_output_text()` | ç”Ÿæˆæ ¼å¼åŒ–çš„è¾“å‡ºæ–‡æœ¬ |
| `save_to_txt(output_path)` | ä¿å­˜ç»“æœåˆ°txtæ–‡ä»¶ |
| `get_product_info()` | è·å–äº§å“ä¿¡æ¯ï¼ˆåç§°ã€ä»£ç ã€æ—¥æœŸèŒƒå›´ç­‰ï¼‰ |
| `run_all()` | æ‰§è¡Œæ‰€æœ‰è®¡ç®—æ­¥éª¤ |

---

# å‘¨æœŸæ€§ä¹°å…¥æ”¶ç›Šè®¡ç®—å™¨

æ ¹æ®æŒ‡å®šçš„ä¹°å…¥è§„åˆ™ï¼ˆå¦‚æ¯å‘¨äº”ä¹°å…¥ï¼‰è®¡ç®—ä»ä¹°å…¥æ—¥æœŸæŒæœ‰è‡³ä»Šçš„æ”¶ç›Šæƒ…å†µã€‚

## å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ç”¨æ³•

```bash
# æ¯å‘¨äº”ä¹°å…¥è§„åˆ™
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule friday

# æ¯æœˆ20æ—¥ä¹°å…¥è§„åˆ™
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule monthly --day 20
```

## å‘½ä»¤è¡Œå‚æ•°è¯´æ˜

### å¿…éœ€å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `-f, --file` | Excelæ–‡ä»¶è·¯å¾„ | `ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx` |
| `--rule` | ä¹°å…¥è§„åˆ™ï¼š`friday`(æ¯å‘¨äº”)ã€`monthly`(æ¯æœˆæŒ‡å®šæ—¥)ã€`weekly`(æ¯å‘¨æŒ‡å®šæ—¥)ã€`specific`(æŒ‡å®šæ—¥æœŸ) | `--rule friday` |

### å¯é€‰å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--day` | æ¯æœˆç¬¬å‡ å¤©ä¹°å…¥ï¼ˆç”¨äº monthly è§„åˆ™ï¼‰ | 20 |
| `--weekday` | æ¯å‘¨ç¬¬å‡ å¤©ä¹°å…¥ï¼Œ0=å‘¨ä¸€ï¼Œ4=å‘¨äº”ï¼Œ6=å‘¨æ—¥ï¼ˆç”¨äº weekly è§„åˆ™ï¼‰ | æ—  |
| `--target-date` | ä¹°å…¥æ—¥æœŸï¼Œæ ¼å¼ YYYY-MM-DD æˆ– YYYYMMDDï¼ˆç”¨äº specific è§„åˆ™ï¼‰ | æ—  |
| `--date` | æŸ¥è¯¢ç‰¹å®šæ—¥æœŸä¹°å…¥çš„æ”¶ç›Šï¼Œæ ¼å¼ YYYY-MM-DD æˆ– YYYYMMDD | æ—  |
| `-o, --output` | è¾“å‡ºæ–‡ä»¶ç›®å½• | `./output` |
| `--format` | è¾“å‡ºæ ¼å¼ï¼š`txt`ã€`excel`ã€`both` | `txt` |

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ¯å‘¨äº”ä¹°å…¥è§„åˆ™

```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule friday
```

**è¯´æ˜**ï¼šè®¡ç®—æ•°æ®èŒƒå›´å†…æ‰€æœ‰å‘¨äº”çš„ä¹°å…¥æ”¶ç›Šï¼Œç»“æœä¿å­˜åˆ° `./output/æ—¥åº¦å‡€å€¼_friday.txt`

### ç¤ºä¾‹2ï¼šæ¯æœˆ20æ—¥ä¹°å…¥è§„åˆ™

```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule monthly --day 20
```

**è¯´æ˜**ï¼šè®¡ç®—æ¯æœˆ20æ—¥ï¼ˆå¦‚æœæ˜¯äº¤æ˜“æ—¥ï¼‰çš„ä¹°å…¥æ”¶ç›Š

### ç¤ºä¾‹3ï¼šæ¯å‘¨ä¸€ä¹°å…¥è§„åˆ™

```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule weekly --weekday 0
```

**è¯´æ˜**ï¼šè®¡ç®—æ¯å‘¨ä¸€çš„ä¹°å…¥æ”¶ç›Š

### ç¤ºä¾‹4ï¼šæŒ‡å®šæ—¥æœŸä¹°å…¥

```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule specific --target-date 2025-11-20
```

**è¯´æ˜**ï¼šè®¡ç®—åœ¨ 2025-11-20 è¿™ä¸€å¤©ä¹°å…¥çš„æ”¶ç›Š

### ç¤ºä¾‹5ï¼šæŸ¥è¯¢ç‰¹å®šæ—¥æœŸä¹°å…¥çš„æ”¶ç›Š

```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule friday --date 2025-11-21
```

**è¯´æ˜**ï¼šåªæŸ¥è¯¢ 2025-11-21 è¿™ä¸ªå‘¨äº”ä¹°å…¥çš„æ”¶ç›Šè¯¦æƒ…

### ç¤ºä¾‹6ï¼šè¾“å‡ºåˆ° Excel å’Œ TXT

```bash
python periodic_buy.py -f ä¹°å…¥å¹³å‡æ”¶ç›Š_å‡€å€¼åˆ—è¡¨/æ—¥åº¦å‡€å€¼.xlsx --rule friday --format both -o ./my_output
```

**è¯´æ˜**ï¼šåŒæ—¶ç”Ÿæˆ Excel å’Œ TXT æ–‡ä»¶ï¼Œä¿å­˜åˆ° `./my_output` ç›®å½•

## è¾“å‡ºæ–‡ä»¶è¯´æ˜

### TXT è¾“å‡ºæ ¼å¼

```
äº§å“åç§° (äº§å“ä»£ç )
æ”¶ç›Šæƒ…å†µè¡¨ï¼ˆæ›´æ–°æ—¥æœŸï¼šYYYY.MM.DDï¼‰
ä¹°å…¥è§„åˆ™ï¼šæ¯å‘¨äº”ä¹°å…¥

----
ä¹°å…¥æ—¥æœŸ           ä¹°å…¥åŸºé‡‘å‡€å€¼      æ¯æ—¥æ¶¨è·Œå¹…   æŒæœ‰å¤©æ•°   åŒºé—´æ”¶ç›Šç‡   åŒºé—´å¹´åŒ–æ”¶ç›Šç‡
----
2025-11-21         1.1319           -2.56%     61       12.71%      104.64%
2025-11-28         1.1653           0.76%      54       9.48%       84.48%
...
----
å¹³å‡                                                      9.89%       92.34%

å…±è®¡ 15 ä¸ªä¹°å…¥æ—¥æœŸï¼Œä¸Šæ–¹ä¸ºæœ€è¿‘ 10 æ¡è®°å½•
å®Œæ•´æ•°æ®è¯·æŸ¥çœ‹è¾“å‡ºæ–‡ä»¶
```

### Excel è¾“å‡ºæ ¼å¼

Excel æ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š
- **ä¹°å…¥æ—¥æœŸ**ï¼šè´­ä¹°æ—¥æœŸ
- **ä¹°å…¥åŸºé‡‘å‡€å€¼**ï¼šè´­ä¹°æ—¶çš„åŸºé‡‘å‡€å€¼
- **æ¯æ—¥æ¶¨è·Œå¹…**ï¼šè´­ä¹°å½“æ—¥ç›¸å¯¹å‰ä¸€ä¸ªäº¤æ˜“æ—¥çš„æ¶¨è·Œå¹…
- **æŒæœ‰å¤©æ•°**ï¼šä»è´­ä¹°åˆ°æœ€æ–°æ—¥æœŸçš„å¤©æ•°
- **åŒºé—´æ”¶ç›Šç‡**ï¼šè´­ä¹°è‡³ä»Šçš„ç´¯è®¡æ”¶ç›Šç‡
- **åŒºé—´å¹´åŒ–æ”¶ç›Šç‡**ï¼šå¹´åŒ–æ”¶ç›Šç‡

## æ‰©å±•ä¹°å…¥è§„åˆ™

å¦‚éœ€æ·»åŠ æ–°çš„ä¹°å…¥è§„åˆ™ï¼ˆå¦‚æ¯æœˆç¬¬ä¸€ä¸ªäº¤æ˜“æ—¥ã€ç‰¹å®šæ—¥æœŸèŒƒå›´ç­‰ï¼‰ï¼Œå¯ä»¥åœ¨ `utils/buy_rules.py` ä¸­ç»§æ‰¿ `BuyRule` ç±»ï¼š

```python
from datetime import datetime, timedelta
from .buy_rules import BuyRule

class MyCustomRule(BuyRule):
    """è‡ªå®šä¹‰ä¹°å…¥è§„åˆ™"""
    
    def get_rule_name(self) -> str:
        return "è‡ªå®šä¹‰è§„åˆ™åç§°"
    
    def get_buy_dates(self, start_date: datetime, end_date: datetime, 
                      available_dates: set) -> list:
        """
        è¿”å›ç¬¦åˆè§„åˆ™çš„æ‰€æœ‰ä¹°å…¥æ—¥æœŸ
        
        Args:
            start_date: æ•°æ®å¼€å§‹æ—¥æœŸ
            end_date: æ•°æ®ç»“æŸæ—¥æœŸ
            available_dates: æ•°æ®ä¸­å¯ç”¨çš„äº¤æ˜“æ—¥é›†åˆ
            
        Returns:
            ç¬¦åˆè§„åˆ™çš„æ—¥æœŸåˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´å‡åºæ’åˆ—ï¼‰
        """
        buy_dates = []
        # å®ç°ä½ çš„è§„åˆ™é€»è¾‘...
        return sorted(buy_dates)
```

ç„¶ååœ¨ `periodic_buy.py` ä¸­å¯¼å…¥å¹¶ä½¿ç”¨è¿™ä¸ªæ–°è§„åˆ™ã€‚
